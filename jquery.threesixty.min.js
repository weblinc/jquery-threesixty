// jquery.threesixty.js
// @weblinc, @jsantell, (c) 2012

(function($){$.fn.threesixty=function(settings){function eMouseMove(event){if(!mouseDown)return;event.touches&&event.touches.length&&(event.preventDefault(),event=event.touches[0]);var $this=$(this),lastPos=$this.data("lastPos"),curPos=event["page"+dragAxis];if(curPos>lastPos+options.sensitivity||curPos<lastPos-options.sensitivity)changeFrame.call($this,curPos>lastPos?1:-1),$this.data("lastPos",curPos)}function eMouseUp(){mouseDown=!1}function eMouseDown(e){e.preventDefault(),mouseDown=!0}function changeFrame(dir){var bgPos=getBackgroundPos.call(this);newPos=bgPos[axis]+options.spriteDim[axis]*dir,newPos>=options.spriteSheetDim[axis]?newPos=0:newPos<0&&(newPos=options.spriteSheetDim[axis]-options.spriteDim[axis]),bgPos[axis]=newPos,console.log(bgPos.x,bgPos.y),this.css("background-position",bgPos.x+"px "+bgPos.y+"px")}function getBackgroundPos(){var pos=(this.css("background-position")||"").split(" ");return{x:parseInt(this.css("background-position-x")||pos[0],10),y:parseInt(this.css("background-position-y")||pos[1],10)}}var options=$.extend({},$.fn.threesixty.defaults,settings),mouseDown=!1,axis=options.spriteSheetDim.x>options.spriteSheetDim.y?"x":"y";dragAxis=options.dragAxis.toUpperCase(),this.each(function(){$(this).mousemove(eMouseMove).mousedown(eMouseDown).data("lastPos",0),this.addEventListener("touchmove",eMouseMove),this.addEventListener("touchstart",eMouseDown)}),document.addEventListener("mouseup",eMouseUp),document.addEventListener("touchend",eMouseUp)},$.fn.threesixty.defaults={dragAxis:"x",sensitivity:3,spriteSheetDim:{x:0,y:0},spriteDim:{x:0,y:0}}})(jQuery)